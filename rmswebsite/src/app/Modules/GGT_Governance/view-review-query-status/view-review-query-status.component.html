<!-- <div style="display: flex; align-items: center;">
  <div style="display: flex; align-items: center; cursor: pointer; color: blue;" (click)="goBack()">
    <span style="font-size: 20px;">&#8592;</span> 
    <span style="margin-left: 5px;">Back</span>
  </div>
  <div style="margin-left: 25px;">
  <h2>View Query/ Issue Details</h2>
</div>
</div> -->
<div style="display: flex; align-items: center;">
  <button (click)="goBack()" class="back-button">ðŸ”™ Back</button>
  <div style="margin-left: 25px;">
  <h2>View Query/ Issue Details</h2>
</div>
</div>


<div class="query-container">
  <h3>Details of Query/ Issue Raised:</h3>
  <table>
    <tr>
      <td><b>Tracking ID:</b> </td>
      <td> {{ queryData.trackingNo }}</td>
      <td><b>Status:</b></td>
      <td> {{ queryData.status }}</td>
    </tr>
    <tr>
      <td><b>Importance:</b></td>
      <td> {{ queryData.queryImportance }}</td>
      <td><b>Module:</b> </td>
      <td> {{ queryData.task_name }}</td>
    </tr>
    <tr>
      <td><b>Main Menu:</b></td>
      <td> {{ queryData.menu_item }}</td>
      <td><b>Component:</b></td>
      <td> {{ queryData.name }}</td>
    </tr>
    <tr>
      <td><b>Subject Title:</b></td>
      <td colspan="3"> {{ queryData.subjectTitle }}</td>
    </tr>
    <tr>
      <td><b>Issue Details:</b></td>
      <td colspan="3"> {{ queryData.issueDetails }}</td>
    </tr>
    <tr>
        <td><b>Attachments:</b></td>
        <td colspan="3">
          <div *ngFor="let file of fileList; let i = index">
            {{ i+1 }}. {{ file.fileName }}
            <button (click)="downloadFile(file.raisequeryfilesid)" style="color: blue;">(Download)</button>
            <!-- <button (click)="downloadFile(file.raisequeryfilesid, file.fileName)">Download</button> -->
            <!-- <a href="{{ file.url }}" target="_blank">Download</a> -->
          </div>
          <!-- <div *ngFor="let file of queryData.filesdata; let i = index">
            {{ i+1 }}. <a href="{{ file.url }}" target="_blank">Download</a>
          </div> -->
        </td>
      </tr>
      <tr>
        <td><b>Issue Raised By/ On:</b></td>
        <td> {{ queryData.raisedPersonName }}/{{queryData.createdDate}}</td>
        <td><b>Reporting Person:</b></td>
        <td> {{ queryData.reportingPersonName }}</td>
      </tr>
  </table>

  <!-- <div class="form-container"> -->
    <div *ngIf="queryData.status=='Open'">
    <h2 class="form-title">Query / Issue Resolution</h2>
  
    <form>
      <!-- Resolution Category Dropdown -->
      <div class="form-group">
        <label for="resolutionCategory">Resolution Category:</label>
        <select id="resolutionCategory" class="form-control1">
          <option value="">Select Category</option>
          <option value="Issue fully resolved">Issue fully resolved</option>
          <option value="Issue wrongly reported">Issue wrongly reported</option>
        </select>
      </div>
  
      <!-- Resolution Details -->
      <div class="form-group">
        <label for="resolutionDetails">Resolution Details:</label>
        <textarea  matInput #Obj_Doc minlength="5" maxlength="1500"  
        id="resolutionDetails" class="form-control" required style="min-height: 50px;overflow: auto;"
        (input)="onInput()" ></textarea>
        <!-- <textarea id="resolutionDetails" class="form-control" maxlength="1500"></textarea> -->
        <small class="info-text">max 1500 chrs</small>
        <small align="end">{{Obj_Doc.value.length}}/1500</small>
      </div>
      <!-- <div fxLayoutAlign="center center">
    <div class="box">
      <mat-form-field appearance="fill" class="form-field">
        <mat-label>Issue Details: </mat-label>
        <textarea  matInput #Obj_Doc minlength="5" maxlength="1500"  
        formControlName="issueDetails" required style="min-height: 50px;overflow: auto;"
        (input)="onInput()" ></textarea>
        <mat-hint align="start">Min 5 - Max 1500 Characters</mat-hint>
        <mat-hint align="end">{{Obj_Doc.value.length}}/1500</mat-hint>
      </mat-form-field>
    </div>
  </div> -->
  
      <!-- Attachments -->
      <div class="form-group">
        <label for="attachments">Attachments:</label>
        <input #attachments type="file" (change)="onFileSelected($event)" [disabled]="files.length >= 5" class="file-input" multiple />
        <p *ngIf="files.length >= 5" class="error-text">Max 5 uploads allowed</p>
        <ul>
          <li *ngFor="let file of files; let i = index">
            {{ file.name }} <button (click)="removeFile(i)" class="remove-btn">Remove</button>
          </li>
        </ul>
        <!-- <input type="file" id="attachments" class="file-input" multiple />
        <small class="info-text">max 5 uploads allowed</small> -->
      </div>
  
      <!-- Buttons -->
      <div class="button-group">
        <button type="button" class="cancel-btn">CANCEL</button>
        <button type="submit" class="submit-btn" (click)="onSubmit()">SUBMIT</button>
      </div>
    </form>
  </div>
  <!-- </div> -->
  
<div *ngIf="queryData.status=='Closed'">
  <h3>Details of Query/ Issue Resolved:</h3>
  <table class="details-table">
    <tr>
      <td><b>Resolution Category:</b> </td>
      <td>  {{ queryData.resolutionCategory }} </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><b>Resolution Details:</b></td>
      <td colspan="3"> {{ queryData.resolutionDetails }}</td>
    </tr>
    <tr>
      <td ><b>Attachments:</b></td>
      <td colspan="3">
        <div *ngFor="let file of fileListReview; let i = index">
          {{ i+1 }}. {{ file.fileName }}
          <button (click)="downloadReviewFile(file.reviewqueryfilesid)" style="color: blue;">(Download)</button>
        </div>
        <!-- <div *ngFor="let file of queryData.resolutionfiles; let i = index">
          {{ i + 1 }}. 
          <span>{{ file }}</span> 
          <a [href]="getDownloadUrl(file)" download target="_blank" style="color: blue;">(Download)</a>
        </div> -->
      </td>
    </tr>
    
    
    <!-- <tr>
      <td colspan="2"><b>Attachments:</b></td>
      <td colspan="3"> 
        <div *ngFor="let file of queryData.resolutionfiles; let i = index">
          {{ i+1 }}. <a href="{{ file.url }}" target="_blank">Download</a>
        </div>
      </td>
    </tr> -->
    <tr>
      <td><b>Issue Resolved By/Resolved on:</b></td>
      <td>  {{ queryData.reportingPersonName || 'N/A'}}/{{queryData.resolutionQueryDate}}</td>
      <td><b>Reporting Person/ on:</b></td>
      <td>  {{ queryData.raisedPersonName || 'N/A'}} / {{queryData.createdDate}}</td>
    </tr>
  </table>
</div>

</div>
