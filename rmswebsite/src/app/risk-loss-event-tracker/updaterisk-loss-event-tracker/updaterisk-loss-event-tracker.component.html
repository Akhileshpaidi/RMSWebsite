<div class="form">
    <div class="body">
      <div class="header">
        <div style="align-self: self-end">
          <br>
          <h2 class=" title" style="align-items: center;"> Update Loss Event Tracker
            </h2>
        </div>
      </div> 
      <br>
      <br>
      <div class="box">
         <div>

           <dx-drop-down-box 
          
           [(value)]="selectedOption"         
           [inputAttr]="{ 'aria-label': 'Owner' }"
           placeholder="Select Loss Event Tracker *"
           label="Select Loss Event Tracker*"
           [showClearButton]="true"
           labelMode="floating"
           valueExpr="losseventtrackerid"
           displayExpr="losseventname"
           [(opened)]="isGridBoxOpened"
           [dataSource]="losseventdata"
           (onValueChanged)="getUpdateFormData($event)"
           >   
          <div *dxTemplate="let data of 'content'">
           <dx-data-grid    
           [dataSource]="losseventdata"
           [columns]="gridColumns1"
             [selection]="{ mode: 'single' }"
             [hoverStateEnabled]="true"
             [(selectedRowKeys)]="selectedOption"
             [filterRow]="{ visible: true }"
             [scrolling]="{ mode: 'virtual' }"
             [showColumnHeaders]="false"
             height="100%"
           >
           <dxo-filter-row [visible]="true"></dxo-filter-row>
           <dxo-scrolling mode="virtual"></dxo-scrolling>
           <dxo-header-filter [visible]="true" [allowSearch]="true">
             <dxo-search [enabled]="true"></dxo-search>
           </dxo-header-filter>
           <dxo-paging [enabled]="true" [pageSize]="10"></dxo-paging>
           <dxo-pager
           [visible]="true"
           [allowedPageSizes]="[ 10,20, 'all']"
          
           [showPageSizeSelector]="true"
          
           [showInfo]="true"
           infoText="Page {0} of  {1} ({2} items)"
           [showNavigationButtons]="true">
         </dxo-pager>
     
         <dxo-group-panel [visible]="true"></dxo-group-panel>
           <dxo-grouping [autoExpandAll]="true"></dxo-grouping>
           </dx-data-grid>
         </div> 
        </dx-drop-down-box>
        
           </div>
      
      </div>
      <br>
      <br>
      <form [formGroup]="keyfocus"  (ngSubmit)="SubmitUpdateForm()" >

        <div class="row">
            <div class="box">
                <div>
                    <dx-select-box 
             formControlName="entity"
             label="Select Entity Type*"
          labelMode="floating"
          valueExpr="entityid"
          displayExpr="entity_Master_Name"
          [dataSource]="Entity"  
          [searchEnabled]="true"
          (onValueChanged)="getunitlocation($event)"
          selectionMode="single" 
          placeholder=""
             > </dx-select-box> 
                  </div>
             
             </div>
             <div class="box">
                <dx-select-box 
                formControlName="location"
                label="Select  unit  location*"
                labelMode="floating"
                valueExpr="unit_location_Master_id"
                displayExpr="unit_location_Master_name"
                [searchEnabled]="true"
                [dataSource]="location"  
                (onValueChanged)="getdepartment($event)" 
                selectionMode="single" 
                  >    </dx-select-box>
            
            </div>
        </div>
        <br>
        <div class="row">
            <div class="box">
                <div>
                    <dx-select-box 
                    formControlName="department"
                    label="Select Department Type *"
                    labelMode="floating"
                    valueExpr="department_Master_id"
                    displayExpr="department_Master_name"
                    [searchEnabled]="true"
                    [dataSource]="Department"  
                    (onValueChanged)="getbusiness($event)"
                    selectionMode="single" 
                      ></dx-select-box>
                  </div>
             
             </div>
             <div class="box">
             <dx-select-box 
             formControlName="businessid"
             label="Select Business Name*"
          labelMode="floating"
          valueExpr="riskBusinessfunctionid"
          displayExpr="riskbusinessname"
          [dataSource]="business"  
          [searchEnabled]="true"
          selectionMode="single" 
          placeholder=""
             > </dx-select-box>
            </div>
        </div>
        <br>
       
     

        <div class="row">
          <div class="box">
                                  <dx-drop-down-box
                                  formControlName="MapUserList"
                                  [(value)]="selectedOption1"         
                                  [inputAttr]="{ 'aria-label': 'Owner' }"
                                  label="Map Reporting User(s)*"
                                  labelMode="floating"
                                  
                                  [dataSource]="UserDatasource"
                                  [(opened)]="isUserBoxOpened"
                                  [valueExpr]="'usR_ID'"
                                  [displayExpr]="gridBox_displayExpr"
                                  (onValueChanged)="onUserSelectionChange($event)"
                                  [deferRendering]="false"
                                  [showClearButton]="true"
                               
                                >
                                  <!-- Content template for the first dropdown -->
                                  <div *dxTemplate="let data of 'content'">
                                    <dx-data-grid
                                    [columns]="usergridColumns"
                                    [selection]="{ mode: 'multiple' }"
                                    [dataSource]="UserDatasource"
                                    [(selectedRowKeys)]="selectedOption1"
                                    [filterRow]="{ visible: true }"
                                    [scrolling]="{ mode: 'virtual' }"
                                      [hoverStateEnabled]="true"
                                      placeholder=""
                                      height="100%"
                                    >
                          
                                      <!-- Data grid configuration for the first dropdown -->
                                    </dx-data-grid>
                                  </div>
                                </dx-drop-down-box>
                            
                              </div>
                      
                         <div class="box">
                          <div class="dx-field-value">
                            <dx-drop-down-box
                            formControlName="exemptionUser"
                            [dataSource]="UserDatasourceSecondDropdown"
                            labelMode="floating"
                            placeholder="Map Additional User(s)*"
                            [(value)]="selectedOption2"
                           
                            [valueExpr]="'usR_ID'"
                            [deferRendering]="false"
                            [(opened)]="isUserBoxOpened1"
                            [displayExpr]="gridBox_displayExprExemptionUser"
                            [deferRendering]="false"
                          
                            [inputAttr]="{ 'aria-label': 'Owner' }"
                            [showClearButton]="true"
                            (onValueChanged)="selectedlisttoremove($event)"
                          >
                            <!-- Content template for the second dropdown -->
                            <div *dxTemplate="let data of 'content'">
                              <dx-data-grid
                                [columns]="usergridColumns"
                                [dataSource]="UserDatasourceSecondDropdown"
                                [hoverStateEnabled]="true"
                                [selection]="{ mode: 'multiple' }"
                                [filterRow]="{ visible: true }"
                                 [scrolling]="{ mode: 'virtual' }"
                                [(selectedRowKeys)]="selectedOption2"
                                height="100%"
                              >
                              >
                                <!-- Data grid configuration for the second dropdown -->
                              </dx-data-grid>
                            </div>
                          </dx-drop-down-box>
                        </div>
                        
                 
  </div>
        </div>
<div class="row">
      
        <div class="dx-fieldset" style="width: 300px;">
            <div class="dx-fieldset-header">Set Rating Level Range</div>
            <div class="dx-field">
              <div class="dx-field-label">On handle movement</div>
              <div class="dx-field-value">
                <dx-range-slider
                  [(start)]="start"
                  [(end)]="end"
                  [min]="1"
                  [max]="999999999999999"
                 
                >
                <dxo-label
                [visible]="true"
                [format]="format"
                position="top"
              ></dxo-label>
                <dxo-tooltip
                [enabled]="true"
                [format]="format"
                showMode="always"
                position="bottom"
              ></dxo-tooltip>
            </dx-range-slider>
              </div>
            </div>
          </div>

    

        </div>
        <div class="row">
            <div class="box">
             
                <dx-number-box
                  [(value)]="start"
                  label="Start value"
                  formControlName="startValue"
                  [min]="1"
                  [max]="999999999999999"
                  [showSpinButtons]="true"
                  [inputAttr]="{ 'aria-label': 'Start Value' }"
                ></dx-number-box>
              
            </div>
            <br>
            <div class="box">
                <dx-number-box
                  [(value)]="end"
                  label="End value"
                  formControlName="endValues"
                  [min]="1"
                  [max]="999999999999999"
                  [showSpinButtons]="true"
                  [inputAttr]="{ 'aria-label': 'End Value' }"
                ></dx-number-box>
             
            </div>
            <div *ngIf="keyfocus.hasError('rangeError')">
              <p class="error-message">Start value must be less than End value.</p>
            </div>
          </div>
          <br>
          <div class="row">
            <div class="box">
                <mat-form-field  appearance="fill" class="form-field">
                    <mat-label>Loss Event Name</mat-label>
                    <input matInput  #titleinput  formControlName="losseventname"  maxlength="150" >
                    <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
                    <mat-hint align="end">{{titleinput.value.length}}/150</mat-hint> 
                  </mat-form-field>
                      </div>
                      <div class="box">
                  <mat-form-field  appearance="fill" class="form-field">
                    <mat-label> Loss Event Description</mat-label>
                    <textarea matInput   #titleinput1 formControlName="description" maxlength="500" ></textarea>
                    <mat-hint align="start" >Min 1 - Max 500 Characters</mat-hint>
                    <mat-hint align="end">{{titleinput1.value.length}}/500</mat-hint> 
          
          
                  </mat-form-field>
            </div>
        </div>     
    <div class="margin-top"></div>
    <div class="button">
     <button class="grey-button"  (click)="Cancel()" >Cancel</button>
      <button class="Custombutton"  >Update</button>
    </div>
   </form>
</div>
</div>