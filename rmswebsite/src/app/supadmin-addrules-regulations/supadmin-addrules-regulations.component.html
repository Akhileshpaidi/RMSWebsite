<div class="form">
    <div class="header col">
      <div style="align-self: self-end">
        <br>
        <h2 class=" title" style="align-items: center;">Add Rules And Regulation
          </h2>
      </div>
    </div>

    <br>
    <form [formGroup]="addrules"    (ngSubmit)="onSubmit()" >
      <mat-horizontal-stepper labelPosition="bottom">
            
        <mat-step label="Add Rules" state="chat">
          <br>
        <br>
      <div class="row">
        <div class="box">
          <dx-select-box 
          formControlName="actregulatoryid"
          label="Select Act Name*"
          labelMode="floating"
          valueExpr="actregulatoryid"
          displayExpr="actregulatoryname"
          [dataSource]="actname"
          height="40px"
          [searchEnabled]="true"
          selectionMode="single" 
         placeholder=""
         disableOptionCentering >
    </dx-select-box>

        </div>
        <div class="box">

          <mat-form-field  appearance="fill" class="form-field">
            <mat-label>Name of Rule /Regulation/Procedure</mat-label>
            <input matInput #titleinput formControlName="act_rule_name"  maxlength="250">
            <mat-hint align="start" >Min 1 - Max 250 Characters</mat-hint>
          <mat-hint align="end">{{titleinput.value.length}}/250</mat-hint>
          </mat-form-field>
        </div>
        </div>
        <div class="row">
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Applicability Description</mat-label>
              <textarea matInput #titleinput formControlName="act_rule_appl_des"  maxlength="2500"></textarea>
              <mat-hint align="start" >Min 1 - Max 2500 Characters</mat-hint>
          <mat-hint align="end">{{titleinput.value.length}}/2500</mat-hint>
            </mat-form-field>
          </div>
          <div class="box">
            <dx-select-box 
            formControlName="category_of_law_ID"
            label="category of Law*"
            labelMode="floating"
            valueExpr="category_of_law_ID"
            displayExpr="law_Categoryname"
            [dataSource]="categorylaw"
            height="40px"
            [searchEnabled]="true"
            selectionMode="single" 
           placeholder=""
           disableOptionCentering >
      </dx-select-box>
          </div>
        </div>
        <div class="button">
          
        <button class="Custombutton" matStepperNext type="button">Next</button>
        </div>
      </mat-step>
      <mat-step label="Jurisdiction Location" state="chat">
      <div class="row">
        <div class="box">
          <dx-select-box 
          formControlName="law_type_id"
          label="Nature  of Law*"
          labelMode="floating"
          valueExpr="law_type_id"
          displayExpr="type_of_law"
          [dataSource]="naturelaw"
          height="40px"
          [searchEnabled]="true"
          selectionMode="single" 
         placeholder=""
         disableOptionCentering >
    </dx-select-box>
        </div>
        <div class="box">
          <dx-select-box 
          formControlName="regulatory_authority_id"
          label="Regulatory Authority*"
          labelMode="floating"
          valueExpr="regulatory_authority_id"
          displayExpr="regulatory_authority_name"
          [dataSource]="regulatory"
          height="40px"
          [searchEnabled]="true"
          selectionMode="single" 
         placeholder=""
         disableOptionCentering >
    </dx-select-box>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="box">
          <dx-select-box 
          formControlName="jurisdiction_category_id"
          label="Jurisdiction  Category *"
          labelMode="floating"
          valueExpr="jurisdiction_category_id"
          displayExpr="jurisdiction_categoryname"
          [dataSource]="jurisdiction"
          height="40px"
          [searchEnabled]="true"
          selectionMode="single" 
         placeholder=""
         disableOptionCentering >
    </dx-select-box>
        </div>
        <div class="box">
          <dx-select-box 
          formControlName="country"
          label="Country Name"
          labelMode="floating"
          valueExpr="jurisdiction_country_id"
          displayExpr="name"
          [dataSource]="country"
          height="40px"
          [searchEnabled]="true"
          selectionMode="single" 
         placeholder=""
         (onValueChanged)="getstate($event)"  disableOptionCentering >
    </dx-select-box>
      
        </div>
      </div>
      <br>
      <div class="row">
        <div class="box">
          <dx-select-box 
              formControlName="state"
              label="State"
              labelMode="floating"
              valueExpr="id"
              displayExpr="name"
              [dataSource]="state"
              height="40px"
              [searchEnabled]="true"
              selectionMode="single" 
             placeholder=""
             (onValueChanged)="getdistrict($event)" disableOptionCentering >
        </dx-select-box>
        </div>
        <div class="box">
          <dx-select-box 
          formControlName="jurisdiction_location_id"
          label="District/Location"
          labelMode="floating"
          valueExpr="jurisdiction_location_id"
          displayExpr="jurisdiction_district"
          [dataSource]="district"
          height="40px"
          [searchEnabled]="true"
          selectionMode="single" 
         placeholder=""
         disableOptionCentering
          >
    </dx-select-box>
        </div>
      </div>
      <div class="button">
        <button class="grey-button" matStepperPrevious>Back</button>
      <button class="Custombutton" matStepperNext type="button">Next</button>
      </div>
      </mat-step>
      <mat-step label="Dependent Factors" state="chat">
        <div class="row">
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Type of Business Organisation</mat-label>
              <input matInput #titleinput1 formControlName="type_bussiness" maxlength="150">
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput1.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Specific Business</mat-label>
              <input matInput #titleinput2 formControlName="bussiness_operations"  maxlength="150">
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput2.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>No of Employees/Workers</mat-label>
              <input matInput #titleinput3 formControlName="no_of_employees"  maxlength="150">
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput3.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Capital Investment of Business Establishment</mat-label>
              <input matInput #titleinput4 formControlName="bussiness_investment"  maxlength="150" >
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput4.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Turnover of Business Establishment</mat-label>
              <input matInput #titleinput5 formControlName="bussiness_turnover"  maxlength="150">
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput5.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label> Specific Working Conditions</mat-label>
              <input matInput #titleinput6 formControlName="working_conditions"  maxlength="150">
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput6.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Conditions imposed through Business Registion/Licence</mat-label>
              <input matInput #titleinput7 formControlName="bussiness_registration"  maxlength="150">
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput7.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
          <div class="box">
            <mat-form-field  appearance="fill" class="form-field">
              <mat-label>Any other Factor</mat-label>
              <input matInput #titleinput8 formControlName="other_factor" maxlength="150" >
              <mat-hint align="start" >Min 1 - Max 150 Characters</mat-hint>
          <mat-hint align="end">{{titleinput8.value.length}}/150</mat-hint>
            </mat-form-field>
          </div>
        </div>
        <div class="button">
          <button class="grey-button" matStepperPrevious>Back</button>
        <button class="Custombutton" matStepperNext type="button">Next</button>
        </div>
      </mat-step>
      <mat-step label="Addittional Reference" state="chat">
       

        <br>
        <div>
          <h3>
          <label>
          
             Add Bare Rule Reference
          </label>
        </h3>
        </div>
   <div>

    <div formArrayName="references">
      <div *ngFor="let reference of references.controls; let key = index;">
        <div [formGroupName]="key"> 
          <div class="row">
            <div class="box">
              <mat-form-field appearance="fill" class="form-field">
                <mat-label>Select Option</mat-label>
                <mat-select formControlName="referenceType" (selectionChange)="onReferenceTypeChange($event.value, key)">
                  <mat-option value="weblink">Weblink</mat-option>
                  <mat-option value="file">File Attachment</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field appearance="fill" class="form-field" *ngIf="reference.get('referenceType')?.value === 'weblink'">

                <mat-label>Weblink</mat-label>
                <input formControlName="referencetypeValue" matInput>
              </mat-form-field>
              <mat-form-field appearance="fill" class="form-field" *ngIf="reference.get('referenceType')?.value === 'file'">

                <mat-label>File Attachment</mat-label>
                <div class="file-input-container">
                  <input matInput formControlName="file_attachment" [value]="reference.get('file_attachment')?.value" readonly style="width: auto;">

                  <label class="file-input-button">
                    Attach
                    <input type="file" accept=".pdf,.doc,.docx,image/jpeg,image/png" (change)="onMainFileSelected($event, key)">
                  </label>
                </div>
              
              </mat-form-field>
              <div>
                <label class="CustomLabel" (click)="removeReferenceField(key)">Remove</label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
            <button class="file-input-button" type="button" (click)="addReferenceField()" >Add More</button>

   </div>
        <div class="button">
          <button class="grey-button" matStepperPrevious>Back</button>
        <button  class="Custombutton"  type="submit" >Save</button>
        </div>
      </mat-step>
      </mat-horizontal-stepper>
    </form>
</div>